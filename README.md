# Schools as Energy Communities
## Campionato Nazionale Siemens 2023
<img src="image/photo.gif" width="150" height="130"> <img src="image/eolico.gif" width="150" height="130">

### Premessa
Con il problema del cambiamento climatico che si fa, di giorno in giorno, sempre più urgente, molti Stati stanno applicando politiche economico-sociali più o meno radicali, finalizzate ad arginare questo catastrofico processo.
In Italia, queste politiche sono state affidate alla responsabilità del “Ministero della transizione ecologica” (ora chiamato  Ministero dell'Ambiente e della Sicurezza energetica). La transizione ecologica è quell’insieme di politiche, di stampo ambientalista, volte a rendere maggiormente sostenibile l’attuale sistema produttivo. L’ormai ex governo Draghi istituì questo ministero non solo, si fa per dire, per affrontare la crisi ambientale, ma anche con un occhio di riguardo per i giovani. L’attenzione del governo per i ragazzi è stata forte e aveva come scopo quello di poter distaccare il loro pensiero da abitudini sbagliate, ormai consolidate. Molti imprenditori si preoccupano infatti solo dell’assetto economico, ignorando il problema sociale che questa crisi ha messo sotto i riflettori. Come chiarisce Francesco Gesualdi dalle pagine di «Avvenire», il 10% della popolazione mondiale più ricca produce il 49% di tutta l’anidride carbonica emessa dai consumi mondiali, il 50% più povero ne produce solo il 7%. Da questo dato emerge la necessità di una radicale riforma sociale, in quanto gli effetti del cambiamento climatico si scateneranno con intensità maggiore verso i popoli e le classi meno abbienti. Questo cammino tuttavia può essere invertito, a patto che si intervenga in tempo, attraverso alcuni cambiamenti del modello economico e dello stile di vita del nostro tessuto sociale. Perché ciò avvenga, è necessario però che il cambiamento sia reso desiderabile e vantaggioso, invece di una dura pillola da buttare giù, in quanto nessuno, quasi sicuramente, abbandonerà il proprio confortevole stile di vita per adottarne un altro scomodo e privo di sfizi. L’aveva già compreso Alexander Langer, il pioniere dell’ambientalismo, quando disse che la transizione sarebbe stata possibile solo se fosse apparsa socialmente desiderabile.

La transizione di cui stiamo parlando presenta dunque tre aspetti: ecologico, economico e sociale.

Il progetto che stiamo presentando cerca di ripercorrerli tutti. Innanzitutto esso ha come obiettivo l’efficientamento energetico, quindi ha un’utilità di tipo sociale. Esso trova infatti una perfetta realizzazione all’interno di comunità energetiche, ovvero in un insieme di famiglie, ma anche di aziende che, facendo ricorso a fonti rinnovabili, si autosostengono energeticamente. Il fare rete è un concetto che si lega indubbiamente a questo progetto e guarda all’esperienza che, ad un altro livello, è stata sperimentata attraverso la creazione di associazioni di cittadini come le reti Lilliput, che hanno avuto tra i loro promotori padre Alex Zanotelli.   

Nei più giovani, queste scelte energetiche vengono sempre più accolte e apprezzate, mentre non si può dire lo stesso delle vecchie generazioni, che non hanno mai cambiato le proprie abitudini, spesso ignare del fatto che sono state proprio queste ultime a portare il mondo nelle attuali condizioni. La transizione ecologica non sembra suscitare un interesse significativo, almeno per il 65% della popolazione mondiale, di cui i due terzi sono over 50. I giovani rappresentano il motore del cambiamento, per condurre il futuro ad una mobilitazione verso una transizione sociale che sia una “conversione” ecologica in grado di mitigare davvero gli effetti del cambiamento climatico. Dobbiamo impegnarci ad un cambiamento drastico delle nostre vite quotidiane, ma anche del modello economico che ci ha portato alle condizioni in cui ci troviamo oggi.

Del resto l’ambientalismo ha un volto giovane, basti pensare all’esperienza di Greta Thumberg, ma anche di Severn Cull Suzuki o Boyan Slat.
Forse non tutti si rendono conto che la sponda del fiume dove ci troviamo è sbagliata, ma il futuro siamo noi e siamo persone diverse dalle generazioni antecedenti: dobbiamo fare quello che non è mai stato fatto in precedenza: garantire un futuro radioso alle prossime generazioni. 


### Finalità
Il presente progetto ha come finalità il monitoraggio energetico di edifici scolastici e di edifici in genere al fine di ottenere:
- in fase **preliminare** le informazioni utili per il risparmio energetico e per il dimensionamento di impianti di produzione da energia rinnovabile a servizio di comunità energetiche;
- a **regime** le informazioni dettagliate circa il consumo e l'utilizzo ottimale degli impianti costituenti future comunità energetiche.

Il monitoraggio energetico si riferisce sia all'energia **elettrica** sia all'energia **termica** o ad altra forma di energia prodotta o immagazzinata.

Il sistema di monitoraggio utilizza componenti a bassissimo costo di dimensioni ridotte e con alto livello di affidabilità. Alimentati a batteria sono adatti per essere inseriti in qualsiasi impianto in modo non intrusivo e sicuro, ovvero senza la necessità di dover intervenire e/o modificare i circuiti oggetto di monitoraggio.
Tali componenti sono in grado di trasmettere le informazioni senza intermediari web direttamente su Google Sheets per essere elaborati da opportuna interfaccia software.

Attualmente in commercio esistono svariati servizi di monitoraggio piu' o meno intrusivi. Ne citiamo qui uno per tutti offerto gratuitamente da [e-Distribuzione](https://www.e-distribuzione.it/servizi/contatore/le-mie-letture.html) con relativa [App per smartphone](https://play.google.com/store/apps/details?id=com.enel.mobile.edistribuzione&hl=it&gl=US). Cercheremo in seguito di sfruttare al meglio questi dati aggregati nei casi in cui risultano disponibili all'utente. Tuttavia si tratta sempre di servizio di monitoraggio che, anche quando attivabile, non interagisce piu' di tanto con l'impianto. Altri servizi/prodotti anche se piu' "interattivi", sono pensati normalmente per un monitoraggio lacale di **una singola utenza**. Vedremo invece come il progetto **Schools as Energy Communities** sia in grado di gestire/coordinare al meglio i consumi di **un gruppo di utenze** disperse su un territorio, come sono appunto le comunità energetiche, ottimizzando altresì i diversi sistemi di accumulo che utilizzano tecnologie differenti con relativi limiti e vantaggi, quali ad esempio le batterie al litio e le batterie al sale fuso.

Il progetto nasce dall'idea di monitorare i consumi della nostra scuola [IIS Galilei Artiglio](https://www.iisgalileiartiglio.edu.it/) per contribuire inizialmente ad individuare ed eliminare sprechi energetici e successivamente per fornire strumenti utili anche all'Amministrazione Pubblica al fine di costituire comunità energetiche di scuole e/o di altre realtà del territorio.

### Peculiarità del progetto
Il presente lavoro si rivolge a tutti, in particolare ai non esperti, utilizzando tecnologie robuste ed affidabili a bassisimo costo e open source come Google Scripts. La parola d'ordine è **semplificare il piu' possibile** rendendo accessibile a chiunque concetti e pratiche che spesso sono per addetti ai lavori. Pensiamo che ognuno debba essere e sentirsi protagonista in questa sfida importante a favore dell'ambiente e che le abilità e le competenze dell'esperto non debbano apparire come un sapere inaccessibile ma un "bene comune" da condividere. In altre parole chiunque abbia uno smartphone e ovunque si trovi è in grado di *addestrare* il sistema di monitoraggio, di leggere i consumi energetici e di interagire con i carichi mediante il PLC Siemens. Se poi in alternativa allo smartphone può indossare un paio di occhiali per la **realtà aumentata** tipo [Google Glass](https://www.google.com/glass/start/), allora può sfruttare appieno le potenzialità del sistema sviluppato, come descritto piu' avanti. Il progetto infatti sfrutta l'interfaccia di Google Sheets per consentire all'utente di **personalizzare** in modo semplice ma potente le proprie richieste.

<img src="image/sheets.gif" width="150" height="130">

Di seguito, oltre al video istituzionale del Campionato Siemens, saranno proposti dei video-tutorial esplicativi sull'addestramento e sull'utilizzo del sistema di monitoraggio.

### Semplificare la parola d'ordine ma ... senza banalizzare !
In passato l'energia elettrica è sempre stata intesa come un **servizio**. Oggi abbiamo compreso che in realtà è un **bene prezioso** da gestire attentamente. La sfida quindi è sfruttare al meglio l'energia, riducendone innanzitutto gli sprechi e consumandola quando è disponibile ed a prezzi vantaggiosi per l'utente. Questa affermazione ovvia, ma di non semplice attuazione, assume un peso maggiore di fronte a comunità energetiche dove la domanda e l'offerta da energia rinnovabile risponde a dinamiche proprie di ciascuna singola realtà costituente la comunità stessa. Tuttavia pensando per esempio alle scuole o ad altre strutture pubbliche affini, sarebbe importante capire a priori i consumi energetici specifici. Ad esempio osservando i consumi necessari all'illuminazione artificiale di due o piu' scuole, si potrebbero confrontare i watt per mq assorbiti per aula a parità di efficienza luminosa tenendo conto ovviamente anche dell'illuminazione naturale. Oppure si potrebbero paragonare i consumi termici di edifici costruiti negli stessi periodi, ovvero con involucri edili simili, per capire quali azioni possono essere intraprese per allineare il piu' possibile i consumi a standard comuni. Per far questo occorre una tecnologia di facile installazione, "leggera" ed a basso costo, che limiti al minimo essenziale i punti di misura. Deve inoltre essere flessibile, cioè in grado di poter utilizzare diverse tipologie di sensori per la misura di svariati parametri fisici (temperatura, luminosità, umidità, corrente, tensione, cosfi, ecc) ma soprattutto essere in grado di comunicare con **PLC Siemens S7 1x00** in modo immediato (ai fini del progetto può essere utilizzata indifferentemente la serie 1200 o la serie 1500) ed essere installata su PLC esistenti attraverso un semplice upgrade del software.

### Realtà aumentata ###
I componenti scelti nel progetto per il monitoraggio "low cost" sono costituiti da microprocessori ESP32 programmati in microPython in grado di scrivere direttamente i valori delle grandezze fisiche d'interesse in tempo reale su [Google Sheets](https://www.google.it/intl/it/sheets/about/) senza intermediari Web. 
Di seguito si riporta lo schema che prevede una espansione per l'acquisizione di quattro segnali analogici utilizzati per la lettura dei consumi elettrici compreso il cosfì e lo schema con un modulo completo di PT100 "pronto all'uso" per la misura delle temperature di mandata e ritorno delle tubazioni di riscaldamento.
Naturalmente gli scenari che si possono costruire sono molteplici. In rete si trovano svariate librerie in microPython che permettono di sfruttare al meglio le caratteristiche di ESP32. Ad esempio cliccando su [questo link](https://awesome-micropython.com/) si possono trovare diversi progetti interessanti.
Tuttavia ci teniamo a precisare che il progetto ***Schools as Energy Communities*** non è frutto di un mero "copia & incolla", ma al contrario le librerie utilizzate sono state sviluppate ad hoc dal gruppo di lavoro dell'IIS Galilei Artiglio al fine di ottenere un risultato unico nel suo genere.
Da notare che gli ESP32 sono alimentati a batteria e quindi sono indipendenti dal resto dell'impianto oggetto di monitoraggio e che lo stato di carica della batteria al litio è anch'esso registrato in una casella di spreadsheet il cui valore, se al di sotto di una soglia stabilita, può essere comunicato al manutentore via e-mail o es WA grazie al servizio [Google Apps Script](https://www.google.com/script/start/) per la sostituzione/ricarica. 

**Schema con espansione analogica per la misura delle GRANDEZZE ELETTRICHE**

<img src="image/schemata.png" width="450" height="250"> <img src="image/TA.png" width="150" height="90">

**Schema con modulo PT100 per la misura di TEMPERATURA**

<img src="image/schemapt100.png" width="450" height="250">

Nel progetto ***Schools as Energy Communities***, qualsiasi sia la grandezza fisica misurata, questa è facilmente accessibile attraverso la **realtà aumentata**.  
Infatti, per migliorare la percezione da parte dell'utente dei consumi, si è pensato di sfruttare una tecnologia che probabilmente in futuro sarà sempre piu' presente nei processi tecnologici. Tuttavia la sfida è stata quella di poter applicare la realtà aumentata anche in contesti piu' generici come quelli di edifici esistenti non tecnologicamente avanzati. 

<img src="image/giphyra.gif" width="320" height="150">

Facendo riferimento agli occhiali [Google Glass Enterprise Edition 2](https://www.google.com/glass/start/), il codice per lo scanner di QR Code è scaricabile da questo [link](https://github.com/googlesamples/glass-enterprise-samples/tree/master/QRCodeScannerSample). Altri esempi di codice per l'utilizzo degli occhiali con comandi vocali ed altro è disponibile alla pagina [Google Glass Enterprise E2](https://developers.google.com/glass-enterprise/samples/code-samples?hl=it).
Questo è lo scenario preferito per il progetto ***Schools as Energy Communities*** che prevede un uso "aperto" della realtà aumentata personalizzabile in base alle necessità dell'utente.

Nel caso ad esempio di impianti elettrici e termici solitamente vetusti a servizio delle scuole, si vuole offrire la possibilità al tecnico e/o al manutentore dell'Amministrazione Provinciale o Comunale, di avere l'andamento dei consumi osservando semplicemente il quadro elettrico o la centrale termica oggetto d'indagine.
Per far questo si possono indossare occhiali tipo [Google Glass](https://www.google.com/glass/start/) o in alternativa si può utilizzare uno smartphone o un tablet qualsiasi ed inquadrare il QR Code posto sul quadro elettrico o sull'utenza. Per la lettura del QR Code il progetto prevede l'utilizzo di [Google Lens](https://play.google.com/store/apps/details?id=com.google.ar.lens&hl=it&gl=US&pli=1).

### PLC S7 1x00: il vero punto di forza ###
Abbiamo detto dell'importanza del monitoraggio condiviso su cloud e della reperibilità delle informazioni mediante QR Code. Adesso si tratta di renderle operative sfruttando il web server del PLC Siemens. Il gruppo di lavoro del Galilei Artiglio ha realizzato un file Javascript in grado di leggere i contenuti delle celle desiderate e di passare i valori alle variabili del PLC. In questo modo il cerchio si chiude, nel senso che gli algoritmi impostati su foglio Sheet possono interagire con le uscite dell' S7 1x00 per la gestione dei carichi d'interesse. 

Soffermiamoci un attimo su questo passaggio: <span style="color:blue">le misure energetiche di diversi impianti dispersi sul territorio, sono raccolte all'interno di un foglio di calcolo presente nel Cloud ed accessibile online da piu' utenti secondo restrizioni impostate. Le celle di detto foglio, valorizzate da specifici algoritmi o da valori impostati dagli stessi utenti, costituiscono l'input per uno o piu' PLC Siemens connessi agli impianti costituenti la comunità energetica. Così un sistema distribuito di edifici attivi-passivi diversi per destinazione ed utilizzo, è gestito in modo integrato come se si trattasse di un unico impianto e dove ogni utente può interagire alla pari con la parte che gli compete. </span>

Vediamo meglio il potenziale di queste tecnologie all'interno di una realtà scolastica. Si è già accennato al fatto che si possono monitorare i carichi specifici, ovvero la potenza assorbita per mq di edificio a seguito dell'illuminazione e del riscaldamento. Adesso con il PLC è possibile intervenire operativamente. Ad esempio per l'illuminazione si può intervenire in quelle aree che presentano in determinate ore una illuminazione naturale piu' che sufficiente in termini di lux, parzializzando o addirittura togliendo l'alimentazione alle lampade al fine di evitare la tipica situazione delle "luci accese anche con il sole". Lo stesso discorso vale per il riscaldamento acceso anche nei giorni di scirocco con le aule a finestre aperte (potremmo chiedere conferma a qualsiasi studente di quante volte durante l'anno capitano nella propria scuola situazioni come queste). Esiste tuttavia un utilizzo piu' spinto che è quello delle "autorizzazioni" al consumo di un bene prezioso come quello dell'energia. 
Pensiamo ad esempio ad una scuola che ha l'ascensore ad uso esclusivo di portatori d'handicap e del personale scolastico. Può accadere che l'ascensore sia utilizzato impropriamente (a volte le chiamate ai piani sono un passatempo durante la ricreazione). Se l'ascensore non è dotato di badge (ma anche se lo fosse non cambia niente), è possibile autorizzarne la chiamata tramite il proprio account scolastico attraverso il QR Code. Così anche l'alimentazione per la fruizione didattica dei laboratori può essere autorizzata dal docente di disciplina secondo il proprio calendario scolastico per il tempo necessario alla lezione.
Vedremo anche l'importanza delle combinazioni di orario per evitare picchi di consumo. Si pensi ad esempio alla sovrapposizione simultanea di piu' laboratori energivori tipo saldatura, misure elettriche con prove su macchine elettriche, grandi aule di informatica, compressori di aule di pneumatica ecc.

In altre parole è possibile individuare porzioni di impianto da attivare con autorizzazione utilizzando semplicemente un account personale. L'attivazione è naturalmente un'azione libera dell'utente che in quel preciso momento però è a conoscenza dell'energia prodotta e consumata dalla comunità energetica. Se ad esempio nell'orario scolastico di un docente sono a disposizione aule alternative dove è possibile svolgere lezioni in quel momento "meno energivore", può darsi che il programma svolto, la necessità di un ripasso o altri validi motivi, possano spingere verso un temporaneo ma "virtuoso" cambio di abitudini.  

Di seguito è data la possibilità al lettore di testare le capacità del file sviluppato dal gruppo di lavoro, in grado di far comunicare il PLC Siemens direttamente con i contenuti di Google Sheets. Per prima cosa inquadrare il QR Code seguente con lo smartphone (si consiglia di utilizzare il menu "Cerca" dell'App [Google Lens](https://play.google.com/store/apps/details?id=com.google.ar.lens&hl=it&gl=US) dopo aver inquadrato il QR Code)


<img src="image/qrcode2.png" width="200" height="200">

Se le cose sono andate a buon fine dovreste trovarvi all'interno di un foglio Sheet dove sono riportati semplicemente dei numeri di colore rosso sotto l'etichetta "Carico 1, Carico 2, ... Carico 6". Inserite dallo smartphone nuovi numeri a piacere facendo attenzione di indicare i decimali con la virgola (i valori numerici si inseriscono in basso a sinistra nel campo fx che appare dopo aver selezionato la cella da modificare).

Aprite con Chrome questo [Link di TEST](https://www.albertodelcarlo.it/see/indextest.html) e dovreste vedere i numeri che avete inserito. Potete cambiarli nuovamente da smartphone e premere il tasto refresh del Browser per l'aggiornamento, oppure attendere il refresh automatico ogni sei secondi.

Non è argomento di questo lavoro la cura dell'interfaccia grafica dei fogli se non nella misura funzionale e comprensibile per il raggiungimento delle finalità citate. Tuttavia si ricordano le diverse possibilità di creazione di interfacce utente attraverso le [Class Ui](https://developers.google.com/apps-script/reference/base/ui) di Google App Scripts nonchè attraverso l'installazione di componenti aggiuntivi dal menu *Estensioni*


### Architettura del sistema di monitoraggio
La figura seguente mostra in sintesi le relazioni tra i principali componenti del sistema di monitoraggio low cost ed i PLC S7 1x00 Siemens. Si ribadisce che le informazioni scambiate tra gli ESP32 ed i PLC con i servizi APP Script utilizzati nel progetto, tra cui Google Sheets, avvengono **senza intermediari Web**.
 
<img src="image/see.png" width="550" height="350">


### Tecnica NILM e una possibile alternativa del Galilei Artiglio ###
La caratterizzazione dei consumi elettrici di piu' utilizzatori attraverso un'unica misura a monte dell'impianto è un argomento studiato da tempo. Si possono trovare online diversi [studi accademici](https://scholar.google.it/scholar?q=non+intrusive+load+monitoring+academic&hl=it&as_sdt=0&as_vis=1&oi=scholart) che trattano l'argomento di questa tecnica che prende il nome di [NILM](https://en.wikipedia.org/wiki/Nonintrusive_load_monitoring) che significa *Non intrusive load monitoring*. Nella sostanza, alla base del metodo, c'è lo studio, la ricerca di come poter **disaggregare** il dato numerico della misura. Infatti ad ogni carico elettrico inserito corrisponde un aumento di corrente totale assorbita. La misura a monte quindi è un dato **aggregato** che corrisponde alla somma di tutte le correnti.

<img src="image/prese.gif" width="150" height="130"> <img src="image/misura.gif" width="150" height="130">

Ogni sforzo dunque è nel tentativo di riconoscere, partendo dal risultato finale ovvero la misura, il valore esatto dei vari contributi che lo generano. In pratica è un percorso inverso da come abitualmente lo conosciamo. E' come dire: il numero 10 è la somma di 3+2+5. Sì è vero, ma è anche il risultato della somma 6+4. Quale delle due ipotesi è quella giusta ? Per tentare di dare una risposta la tecnica NILM utilizza reti neurali ad hoc in combinazione al tipo di sensori utilizzati. Normalmente si tratta di sistemi chiusi o proprietari, ciascuno con un proprio grado di affidabilità.

Il progetto dell'[IIS Galilei Artiglio](https://www.iisgalileiartiglio.edu.it/) accoglie dunque la seguente sfida: <span style="color:green"> è possibile caricare su un PLC Siemens un algoritmo NILM per disaggregare real-time le misure di un sistema "leggero" che sfrutta come cloud Google Sheets? E l'algoritmo NILM è veramente così potente ed affidabile da rispettare rigorosamente la prima legge di Kircchoff? Ed ancora, pur essendo un algoritmo "potente" è anch'esso "leggero" da un punto di vista software così che si possa fare in qualsiasi momento un upgrade anche per PLC già funzionanti, non necessariamente programmati nell'ambito del risparmio energetico?</span> La risposta è nel prosieguo del presente lavoro. 
Si ricorda tuttavia che il sistema di monitoraggio è pensato sia per carichi **elettrici** sia per **termici** ed inoltre l'ambito di applicazione dell'algoritmo seguente va oltre le comunità energetiche rivolgendosi anche a tutte quelle realtà operative in ambito terrestre e navale che vogliono conoscere gli assorbimenti dei singoli carichi.

*Passiamo quindi dalle parole ai fatti per vedere se effettivamente esiste una risposta ai tre quesiti formulati*   

Di seguito si riporta un esempio con cinque utenze. Essendo una simulazione offline del PLC, per avere risultati credibili, si raccomanda il lettore di completare i valori dei campi secondo il criterio della prima legge di Kircchoff. Ovviamente se la **somma fasoriale** non è rispettata il sistema risponderà con un messaggio di alert. 
Esistono due versioni software: 
- la prima carica i valori dai campi di Google Sheets ed elabora il risultato attraverso il web server del PLC;
- la seconda carica i valori dal PLC (che nella simulazione off-line devono essere inseriti dall'utente) ed elabora il risultato sempre attraverso il web server del PLC.

Per collegarsi alla prima simulazione occorre inquadrare il QR Code seguente per accedere al foglio di calcolo 

<img src="image/QRnilm.png" width="210" height="210">

Cliccare poi sul link del web server del PLC Siemens e premere il pulsante di analisi dell'algoritmo NILM dopo aver valorizzato le celle di spreadsheet. L'errore assoluto impostabile dall'utente deve essere maggiore di zero (non esistono misure senza errori). Se due o piu'correnti sono esattamente uguali in modulo e fase (caso raro ma non impossibile) rispetto all'errore assoluto, l'algoritmo propone la soluzione scegliendo una corrente dall'insieme dei casi possibili. Va ricordato che nei casi reali due o piu' carichi esattamente uguali sono intercambiabili ai fini energetici.

<img src="image/plc.png" width="150" height="130"> [Link Web Server PLC Siemens](https://www.albertodelcarlo.it/see/sumcombinenilm.html)

Per collegarsi alla seconda simulazione cliccare sul successivo link 

<img src="image/plc.png" width="150" height="130"> [Link Web Server PLC Siemens](https://www.albertodelcarlo.it/see/sumcombine.html)

La conoscenza del dato disaggregato, ovvero dell'assorbimento dei singoli carichi, permette di:
- stabilire un eventuale elenco di utenze secondarie da disconnettere in caso di consumo eccessivo rispetto all'accumulo considerato e/o dell'irraggiamento solare;
- conoscere il cosfì del singolo utilizzatore per un eventuale rifasamento;
- conoscere l'effettivo consumo del singolo utilizzatore anche in termini di manutenzione programmata/efficienza nel tempo;
- valorizzare economicamente l'utilizzo delle utenze piu' significative da un punto di vista dei consumi per un impiego piu' oculato;
- valutare economicamente le sostituzioni con utenze che utilizzano tecnologie piu' moderne (es. led, inverter, controllori PID ecc.);
- migliorare/modificare le abitudini di consumo dell'utente grazie anche all'utilizzo combinato con il PLC Siemens S7 1x00.

La "bontà" delle misure della corrente e del cosfì totale può essere eventualmente verificata/allineata alle misure messe a disposizione ogni 15 minuti dal servizio di [e-Distribuzione](https://www.e-distribuzione.it/servizi/contatore/le-mie-letture.html) sottoforma di file csv da importare in Google Sheet. In questo modo il servizio di e-Distribuzione può essere integrato con il sistema di monitoraggio proposto nel presente lavoro. 

Naturalmente anche in questo caso il collegamento al web server del PLC potrebbe avvenire sfruttando occhiali di realtà aumentata recuperando le informazioni da smarphone.
Per chi volesse approfondire l'aspetto matematico del modello proposto nel file JS che tratta la prima legge di Kirchhoff può cliccare [qui](https://www.albertodelcarlo.it/see/dsemplici.html).

### Ottimizzare le abitudini di consumo con il PLC S7 1x00 ###
Apparentemente un sistema energetico efficientato alla tecnica vigente ed in modo sostenibile da un punto di vista economico, non ha ulteriori margini di miglioramento se non nell'ottimizzazione delle abitudini di consumo. In generale però, modificare le proprie abitudini non è mai una cosa facile. Ancor di meno se si tratta di attività quotidiane ritenute "necessarie e irrinunciabili". Il progetto **Schools as Energy Communities** si pone appunto l'obiettivo di facilitare il piu' possibile l'interazione tra l'utente ed i consumi energetici, consigliandolo nelle scelte di risparmio possibili attraverso la ***realtà aumentata con interfaccia vocale***. Abbiamo già visto che in alternativa alla realtà aumentata può essere utilizzato un tablet od uno smartphone. Di seguito vedremo come l'utente può ricevere consigli vocali circa la scelta di scenari possibili di risparmio energetico.

Una volta caratterizzato l'impianto con le misure di assorbimento dei carichi e valorizzate le celle spreadsheet, il sistema è pronto per ***l'interazione vocale*** con l'utente attraverso il PLC Siemens S7 1x00. Nella simulazione che segue si è scelto di interagire con tre carichi che rappresentano altrettanti laboratori messi a disposizione nell'orario scolastico di un ipotetico docente libero di scegliere. La simulazione è ovviamente rappresentativa di un insieme piu' vasto di casi. Gli scenari che possono essere raccolti in un foglio Google Sheet sono tanti quanto la fantasia e la capacità dell'[energy manager](https://it.wikipedia.org/wiki/Energy_manager) incaricato dall'Amministrazione Pubblica al conseguimento del risparmio energetico. Ci teniamo a ribadire che gli attori chiamati al risparmio siamo tutti noi: studenti, docenti, personale pubblico di qualsiasi livello, cittadini ... in pratica gli utenti. L'esempio seguente si basa sulla realtà scolastica dell'IIS Galilei Artiglio dove la turnazione degli orari dei docenti di disciplina non consente mai di poter scegliere tra piu' di tre laboratori di indirizzo per mattina.

Nella simulazione il lettore può modificare le potenze generate dall'impianto fotovoltaico e dalle batterie di accumulo. Si tratta naturalmente di uno scenario esemplificativo che però comunica tutta la potenzialità degli strumenti utilizzati. Anche l'interfaccia vocale è uno degli strumenti possibili, sicuramente adatto a tutti e di efficacia comunicativa immediata. Si fa notare che nella misura della potenza totale assorbita non sono presenti i consumi dei laboratori A1, A2 ed A3 che rappresentano la scelta futura dell'utente.

Per accedere al foglio di Google Sheet inquadrare il QR Code.

<img src="image/qrparla1.png" width="180" height="180">

Per collegarsi all'interfaccia vocale cliccare sul link del web server del PLC Siemens. Al solito per un impianto reale tutte le celle sarebbero valorizzate dalle misure in tempo reale degli ESP32. Qui nella simulazione il lettore può modificare soltanto le celle con il bordo rosso ed arancio che riproducono la potenza disponibile accumulata nelle batterie e quella prodotta istantaneamente da fonte rinnovabile.

<img src="image/plc.png" width="150" height="130"> [Link Web Server PLC Siemens](https://www.albertodelcarlo.it/see/speach.html)

L'esempio precedente tratta di laboratori, ma nello stesso modo potrebbero essere fornite indicazioni circa i consumi dei sistemi di illuminazione, nonchè di singoli carichi quali fotocopiatrici, distributori di servizi (es. bibite, merende), impianti di climatizzazione locali, ecc.

### Cenni sul monitoraggio dei consumi termici ###
L'ESP32 utilizzato in combinazione con vari tipi di trasduttori è di fatto un sensore flessibile in grado di trasmettere le misure direttamente su Google Sheets. Se configurato per la lettura della temperatura mediante PT100 è in grado anche di fornire i consumi termici degli edifici. In pratica è sufficiente misurare la variazione di temperatura tra la mandata ed il ritorno del fluido termovettore una volta nota la portata del circolatore. I valori ottenuti possono essere valorizzati direttamente dalle celle di calcolo e passati al web server del PLC per il controllo e/o l'interazione vocale con l'utente. Per circolatori a portata variabile è necessario integrare alla PT100 un flussostato.
I circolatori a servizio dell'impianto termico del Galilei Artiglio sono circolatori a portata impostabile manualmente mediante selettore. Di seguito è riportata una simulazione offline dove il lettore può modificare le temperature e la portata del circolatore al fine di avere il consumo termico dell'edificio.

Come nel caso precedente per accedere a Google Sheet inquadrare il QR Code

<img src="image/QRthermo.png" width="210" height="210">

e interagire con l'interfaccia vocale dell'impianto termico cliccando sul link sottostante

<img src="image/plc.png" width="150" height="130"> [Link Web Server PLC Siemens](https://www.albertodelcarlo.it/see/speachth.html)

### Analisi dei risultati e proposte di efficientamento ###
Il progetto **Schools as Energy Comunities** ha visto il coinvolgimento dell'ufficio tecnico dell'Amministrazione Provinciale di Lucca che si è reso disponibile nel fornire lo storico dei consumi energetici dell'Istituto. Questo ha consentito agli studenti di potersi confrontare con dati oggettivi e di formulare proposte utili finalizzate al risparmio energetico. Riportiamo di seguito le idee che sono emerse durante l'attività di brain storming e che hanno a nostro avviso una fattibilità pratica sia in termini tecnici che economici. 

Si ricorda che il presente progetto intende fornire informazioni utili da utilizzare in strumenti accurati di valutazione per la costituzione di comunità energetiche come lo strumento [Recon di Enea](https://recon.smartenergycommunity.enea.it/)

- ### Energia Elettrica ###
Per quanto riguarda le proposte di ottimizzazione dei consumi di energia elettrica si è proceduto inizialmente ad una analisi delle bollette elettriche dove è emerso che i consumi annuali ammontano a circa 85MWh per la fascia F1 e 30MWh per le fascie F2 ed F3. L'Istituto svolge infatti corsi di serale per gli adulti. Tuttavia i consumi in fascia F3 non sembrano giustificabili. Tra le ragioni possibili i sistemi di illuminazione artificiale affidati a tecnologie non a led nonchè la disattivazione di utenze inutilizzate.

I consumi sopra indicati sono al netto dell'energia prodotta dall'attuale impianto fotovoltaico che presenta una producibilità annua decisamente inferiore ai valori attesi. In altre parole l'impianto fotovoltaico ha perduto gran parte dell'efficienza ed alcuni moduli molto probabilmente devono essere sostituiti. Tale affermazione è avvalorata dai valori energetici medi attesi per le coordinate geografiche dell'Istituto 43°53'28"N 10°14'36"E ricavabili dall'[Atlante italiano della radiazione solare](http://www.solaritaly.enea.it/) di Enea.

I picchi di potenza assorbita sono concentrati nella mattina e raggiungono valori massimi dell'ordine degli 80kW. Supponendo di realizzare un impianto fotovoltaico di potenza pari a 90kWp ed avendo a disposizione le superfici di copertura necessarie per la taglia designata, è possibile eliminare la cabina MT/BT passando ad una fornitura in BT. E' consentito infatti, fino a 100kWp, collegare un impianto fotovoltaico in BT. Infatti il costo lordo attuale in bolletta del kWh (pari a 0,318 euro ottenuto dal rapporto della fattura rispetto ai kwh complessivi consumati nello stesso periodo) non giustificherebbe gli oneri necessari alle verifiche periodiche di terra necessarie per i sistemi TN con cabina propria. Il passaggio ad un sistema TT eliminirebbe il problema delle tensioni trasferite a seguito di guasto lato MT, ovvero risolverebbe definitivamente il problema delle tensioni di passo e contatto e del loro mantenimento al di sotto dei limiti di guardia.

In uno scenario di questo tipo oltre al beneficio di tipo ambientale si avrebbe anche un beneficio di tipo paesaggistico trattandosi di superfici importanti di copertura da poter sfruttare posti in zone periferiche non soggette a particolari vincoli urbanistici. 

Per quanto riguarda le buone pratiche di risparmio energetico, come mostrato nel video, è auspicabile un migliore controllo dell'utilizzo degli aerotermi a servizio dei laboratori. Essendo ambienti costituiti da involucri edilizi che non assicurano alcuna capacità termica, gli aerotermi sono dimensionati per riscaldare rapidamente l'aria. Nelle ore in cui i laboratori non sono utilizzati è fondamentale mantenere gli aerotermi spenti al fine di evitare sprechi inutili. Il transitorio termico per portare la temperatura dei laboratori al valore convenuto è di pochi minuti. L'utilizzo di un PLCS7 1x00 può migliorare il risparmio energetico gestendo l'accensione degli aerotermi in modo opportuno.

- ### Energia Termica ###

Pompe di calore a gas


### Conclusioni ###

#### Video  ####
Video di presentazione del progetto

<img src="image/uc.png" width="220" height="140">


